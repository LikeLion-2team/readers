{{>layout/header}}
<style>
	.slider-container {
		border: 10px solid brown;
		overflow: hidden;
		width: 800px;
		margin: auto;
	}

	.slider-inner {
		white-space: nowrap;
		transition: transform 0.3s ease-out;
	}

	.slider-inner img {
		width: calc(33.333% - 20px);
		width: 245px;
		height: 400px;
		border: 4px solid rgb(117, 30, 30);
		margin: 5px;
		margin-right: 5px;
		box-sizing: border-box;
		display: inline-block;
		vertical-align: top;
		object-fit: cover;
	}
</style>
<style>
	body,
	html {
		margin: 0;
		padding: 0;
		height: 100%;
		overflow: hidden;
	}

	.container {
		display: flex;
		min-height: 100vh;
	}

	.main-content {
		flex-grow: 1;
		height: 100vh;
		overflow: auto;
	}

	.sidebar {
		width: 250px;
		background-color: rgb(0, 128, 0);
		padding: 20px;
		overflow-y: auto;
		height: 100vh;
		box-sizing: border-box;
		position: fixed;
		right: 0;
		top: 0;
	}
</style>

<body>
	<h1>메인입니다.</h1>
	<div class="sidebar">
		<div>사이드바</div>
	</div>
	<hr />
	{{mainList.galleryList}}
	<div class="slider-container" id="gallery-Hot-5">
		<div class="slider-inner" id="galleryImgs">
			<img id="galleryImg-1" src="images/book/1.jpeg" alt="dummy1">
			<img id="galleryImg-2" src="images/book/2.jpeg" alt="dummy2">
			<img id="galleryImg-3" src="images/book/3.jpeg" alt="dummy3">
			<img id="galleryImg-4" src="images/book/4.jpeg" alt="dummy4">
			<img id="galleryImg-5" src="images/book/5.jpeg" alt="dummy5">
			<img id="galleryImg-6" src="images/book/1.jpeg" alt="dummy1">
			<img id="galleryImg-7" src="images/book/2.jpeg" alt="dummy2">
		</div>
	</div>
	<h1>책장 부분입니다.</h1>
	<hr />
	{{mainList.boardList}}
	<h1>책갈피 부분입니다.</h1>
	<hr />
	<h1>따로 호출해서 차트 넣어야하는 부분 ajax로</h1>
	<hr />
	{{>layout/footer}}
</body>

</html>
<script>
	$(() => {
		const sliderInner = $("#galleryImgs");
		const totalImages = sliderInner.children().length - 2;
		const imageWidth = sliderInner.find('img').first().outerWidth(true);
		const totalWidth = imageWidth * totalImages;
		sliderInner.width(totalWidth);

		let currentIndex = 0;
		let isDragging = false;
		let startPos = 0;
		let currentTranslate = 0;
		let animationInterval;


		function slideImage(index, noAnimation = false) {
			if (noAnimation) {
				sliderInner.css("transition", "none");
			} else {
				sliderInner.css("transition", "transform 0.3s ease-out");
			}
			currentTranslate = -index * imageWidth;
			sliderInner.css("transform", `translateX(${currentTranslate}px)`);

			// 순환 로직
			if (index >= totalImages - 2) {
				currentIndex = 0;
				setTimeout(() => slideImage(currentIndex, false), 300);
			}
		}

		// 자동 슬라이드 시작 함수
		function startAutoSlide() {
			animationInterval = setInterval(() => {
				currentIndex++;
				if (currentIndex >= totalImages) {
					currentIndex = 0;
					slideImage(currentIndex, false);
				} else {
					slideImage(currentIndex);
				}
			}, 3000);
		}


		function stopAutoSlide() {
			clearInterval(animationInterval);
		}


		startAutoSlide();



		// 차트 호출 테스트
		console.log("차트 호출 함수 진행 중입니다.");
		$.ajax({
			url: "/chart",
			method: "get",
			dataType: "json",
			data: {
				totalVisiteCount: "totalVisiteCount",
				dayVisiteCount: "dayVisiteCount",
				weekVisitorCount: "weekVisitorCount",
			}
		})
			.done((res) => {
				console.log(res);
			})
			.fail((res, err, status) => {
				console.log("fail res : " + res);
				console.log("fail err : " + err);
				console.log("fail status : " + status); // 오타 수정: staus -> status
			});
	});
</script>